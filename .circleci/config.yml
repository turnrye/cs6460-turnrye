version: 2
jobs:
  build:
    docker:
      - image: jpbernius/pandoc:latest
    steps:
      - checkout
      - run:
          name: Generate assignment 1
          command: |
            pandoc --filter pandoc-citeproc assignment-1.md -o assignment-1.pdf
            pandoc --filter pandoc-citeproc assignment-1.md -o assignment-1.epub
      - run:
          name: Generate assignment 2
          command: |
            pandoc --filter pandoc-citeproc --bibliography assignment-2.bibtex assignment-2.md -o assignment-2.pdf
            pandoc --filter pandoc-citeproc --bibliography assignment-2.bibtex assignment-2.md -o assignment-2.epub
      - run:
          name: Generate assignment 3
          command: |
            pandoc --filter pandoc-citeproc assignment-3.md -o assignment-3.pdf
            pandoc --filter pandoc-citeproc assignment-3.md -o assignment-3.epub
      - run:
          name: Generate project proposal
          command: |
            pandoc --filter pandoc-citeproc --bibliography project-proposal.bibtex project-proposal.md -o project-proposal.pdf
            pandoc --filter pandoc-citeproc --bibliography project-proposal.bibtex project-proposal.md -o project-proposal.epub
      - run:
          name: Generate milestone 1
          command: |
            pandoc --filter pandoc-citeproc --bibliography milestone-1.bibtex milestone-1.md -o milestone-1.pdf
            pandoc --filter pandoc-citeproc --bibliography milestone-1.bibtex milestone-1.md -o milestone-1.epub
      - run:
          name: Generate milestone 2
          command: |
            pandoc --filter pandoc-citeproc --bibliography milestone-1.bibtex milestone-2.md -o milestone-2.pdf
            pandoc --filter pandoc-citeproc --bibliography milestone-1.bibtex milestone-2.md -o milestone-2.epub
      - store_artifacts:
          path: /root/project/assignment-1.pdf
      - store_artifacts:
          path: /root/project/assignment-1.epub
      - store_artifacts:
          path: /root/project/assignment-2.pdf
      - store_artifacts:
          path: /root/project/assignment-2.epub
      - store_artifacts:
          path: /root/project/assignment-3.pdf
      - store_artifacts:
          path: /root/project/assignment-3.epub
      - store_artifacts:
          path: /root/project/project-proposal.pdf
      - store_artifacts:
          path: /root/project/project-proposal.epub
      - store_artifacts:
          path: /root/project/milestone-1.pdf
      - store_artifacts:
          path: /root/project/milestone-1.epub
      - store_artifacts:
          path: /root/project/milestone-2.pdf
      - store_artifacts:
          path: /root/project/milestone-2.epub